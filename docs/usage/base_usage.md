## 概述

**SMap**一般由终端命令进行调用。输入不加参数的`smap`可查看当前支持的探测模式、探测模块、输出模块等关键信息。

以`-参数名称简写字母 参数值` 或`--参数名称 参数`形式传入的参数为系统级参数，可通过`smap -h`的方式查看。

以`-a 参数名=参数值`方式传入的参数为探测模式（或模块）的**自定义参数**，由探测模式（或模块）独立解析使用。

## IPv4 基础探测模式

以10m速率对 单个IPv4[**地址, 范围, 网段**] 进行 **ICMP存活** 扫描

注: 如需同时对**多个不连续的IP[地址, 范围, 网段]**进行探测，请参考[混合示例](#混合探测模式)

```shell
smap -m c4 -b 10m -t 171.67.70.0/23
```

以10m速率对 单个IPv4[**地址, 范围, 网段**] 进行 **TCP_SYN端口** 扫描

```shell
smap -m c4 -b 10m --probe_v4 tcp_syn_scan_v4 -t 110.242.68.5 -p 80,442-443
```

以10m速率对 IPv4[**地址文件,  地址端口对文件**] 进行 **ICMP存活** 扫描

```shell
# 注意: 文件名中可以使用 _num目标数量_  _min最小ip值_  _max最大ip值_ 等标记优化扫描
# ip值类型: u32(ipv4) 或 u128(ipv6), 如: test_num10_min0_max10_.txt
smap -m f4 -b 10m -f your_path
```

以10m速率对 IPv4[**地址文件,  地址端口对文件**] 进行 **TCP_SYN端口** 扫描

```shell
# 未指定端口, 将从文件中读取
# 格式:  地址|端口 , 注意每行是一个端口对, 如果 某行 为地址, 其端口将被置为0 
# 如需对同一目标进行多端口探测, 请设置为多行, 如:
# 地址1|端口1
# 地址1|端口2
smap -m f4 -b 10m --probe_v4 tcp_syn_scan_v4 -f your_path

# 指定端口, 忽略文件中的端口, 按指定端口进行探测
# 如果指定为0, 将从文件文件读取
# 如指定端口为 0,80,443 , smap将对所有端口对进行 文件指定端口,80,443端口 共计三种端口的探测
# 注意地址不要重复
smap -m f4 -b 10m --probe_v4 tcp_syn_scan_v4 -f your_path -p 0,22,443
```

## IPv6 基础探测模式

以10m速率对 单个IPv6[**地址, 范围, 网段**] 进行 **ICMP存活** 扫描

```shell
smap -m c6 -b 10m -t 2001:1208:ffff:ffff:ffff:ffff:ffff:e/126
```

以10m速率对 单个IPv6[**地址, 范围, 网段**] 进行 **TCP_SYN端口** 扫描

```shell
smap -m c6 -b 10m --probe_v6 tcp_syn_scan_v6 -t 240e:83:205:58:0:ff:b09f:36bf -p 80,442-443
```

以10m速率对 IPv6[**地址文件,  地址端口对文件**] 进行 **ICMP存活** 扫描

```shell
smap -m f6 -b 10m -f your_path
```

以10m速率对 IPv6[**地址文件,  地址端口对文件**] 进行 **TCP_SYN端口** 扫描

```shell
# 未指定端口, 将从文件中读取  格式同ipv4
smap -m f6 -b 10m --probe_v6 tcp_syn_scan_v6 -f your_path

# 指定端口, 忽略文件中的端口, 按指定端口进行探测  格式同ipv4
smap -m f6 -b 10m --probe_v6 tcp_syn_scan_v6 -f your_path -p 0,22,443
```

## IPv6 模式字符串

以10m速率对 单个IPv6[**模式字符串**] 进行 **ICMP存活** 扫描

```shell
# 使用@字符标志模式位, 模式位将被置为01全排列
# 如模式位为 61-64,128 则将该ipv6的 相应位 置为01全排列, 共计32个目标ip
smap -m c6p -b 10m -t 2001:1218:101:11d::1@61-64,128

# 如果不使用@标志, 将默认为二进制模式字符串, *字符标记的模式位将被置为01全排列
# 除 0, 1, * 以外的其它字符将被忽略, 可用_符号等做长度标记
smap -m c6p -b 10m -t 001000000000000100010010000110000000000100000001000000010001****_000000000000000000000000000000000000000000000000000000000000000*
```

以10m速率对 单个IPv6[**模式字符串**] 进行 **TCP_SYN端口** 扫描

```shell
smap -m c6p -b 10m --probe_v6 tcp_syn_scan_v6 -t 2001:1218:101:11d::1@61-64,128 -p 80,442-443
# 或
smap -m c6p -b 10m --probe_v6 tcp_syn_scan_v6 -t 001000000000000100010010000110000000000100000001000000010001****_000000000000000000000000000000000000000000000000000000000000000* -p 80,442-443
```

## 混合探测模式

!> 同时进行IPv4和IPv6探测可能会导致更大的性能消耗和时间消耗。如非必要请不要使用，尤其是在一些对性能和探测时间要求严格的任务中。**该模式下IPv4和IPv6可同时出现, 也可以只有IPv4或只有IPv6**。

以10m速率对 **多个**IPv4, IPv6[**地址, 范围, 网段**] 进行 **ICMP存活** 扫描。

```shell
smap -m c46 -b 10m -t 220.181.38.149-220.181.38.150,42.81.179.153,20.76.201.171,240e:c2:1800:166:3::3d7-240e:c2:1800:166:3::3d8,240e:928:1400:1000::25,2603:1020:201:10::10f
```

以10m速率对 **多个**IPv4, IPv6[**地址, 范围, 网段**] 进行 **TCP_SYN端口** 扫描

```shell
smap -m c46 -b 10m --probe_v4 tcp_syn_scan_v4 --probe_v6 tcp_syn_scan_v6 -t 220.181.38.149-220.181.38.150,42.81.179.153,20.76.201.171,240e:c2:1800:166:3::3d7-240e:c2:1800:166:3::3d8,240e:928:1400:1000::25,2603:1020:201:10::10f -p 80,442-443
```

## 结果保存 

扫描结果默认存储在安装目录下：

- `records/`：扫描日志和摘要
- `result/`：存活主机和端口数据

可通过以下方式修改存储路径：

1. 编辑`sys_conf.ini`配置文件
2. 运行时传入路径参数（优先级高于配置文件）

!> 注意：相对路径基于安装目录，绝对路径需完整指定

